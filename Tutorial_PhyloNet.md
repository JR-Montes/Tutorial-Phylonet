## PhyloNet
Julio 2018


PhyloNet es software que puede ocupar un archivo de árboles de genes  (Than et al. 2008). Este programa puede realizar un análisis de coalescencia con o sin reticulaciones (Hibridización e Introgresión). Actualmente, la versión que usa parsimonia da más flexibilidad para juegos de datos grandes. Phylonet permite correr hasta **cuatro** eventos de reticulación independientemente de la aproximación que se seleccione. El programa puede correr con las siguientes aproximaciones:



| Abreviación | Aproximación |  
| ------   | ------ |
|**MP** |Máxima Parsimonia| 
|**ML** | Máxima Verosimilitud|
|**MPL**| Pseudoverosimilitud   |
|**MCMC_GT**|Inferencia Bayesiana|



**NOTA** La demanda computacional y el tiempo de ejecución dependen de la aproximación que se utilice, el número de genes y el número de terminales. Se recomienda no usar más de 10 terminales para los análisis de ML, MPL y MCMC si cuentas con más de 100 genes. 

___

**Instalar**:

[Phylonet](https://bioinfocs.rice.edu/phylonet)

[Dendroscope](http://dendroscope.org)


**Requisitos**

1. Concatenar todo los mejores árboles de RAxML

```
cat RAxML_best* > alltrees.tre
awk '{ printf " = "; print }' alltrees.tre > alltrees1.tre
nl -ba -w1 -s ' ' alltrees1.tre > alltrees2.tre
awk '{ printf "Tree "; print }' alltrees2.tre > alltrees3.tree

```

2. Armar un archivo en formato NEXUS con los árboles de genes para analizar en `nano`. 

`nano  alltrees3.tre`


Hay que agregar dos líneas al inicio del archivo:

```
#NEXUS
begin trees;

Y esto al final del archivo:
end;
begin phylonet;
Infer_ST_MDC (1-339);
[InferNetwork_MP (1-339) 1 -di -pl 4 -x 20;]
end;
```


**Ejemplo**:


```
#NEXUS
begin trees;

Tree 1  = (pincCOA01:0.00320742394604653326,(maxtZAC01:0.00467580336646888743,(johaZAC01:0.01236739908369280209,(rzedMICH01:0.01284886447579834494,((((((culmNL02:0.00298884782775988341,fallUTAH01:0.00755873080923663825):0.00000100000050002909,remoCOA01:0.00000100000050002909):0.00000100000050002909,cemdSLP01:0.00148437532499297743):0.00150178000518045641,orizPUE01:0.00301820867824393940):0.00147451090577672300,laguBCS01:0.00598295626997732023):0.00000100000050002909,((((bung03s3A:0.00450307619005711843,gera01S1:0.01589673769581859825):0.00616312575088980366,(krem03N12:0.01929357773056601319,lamb1195:0.00620300269251307639):0.00143343133150750611):0.01417504259301625817,((caliCAL05:0.01705846200371995830,quadBC01:0.00000100000050002909):0.00199395931498784398,(edulUTAH02:0.00348575584493812001,monoCAL01:0.00245547906388908759):0.00149359570287718041):0.00244246615201747794):0.00000100000050002909,((longUTAH01:0.02246409806569600945,aris05S2:0.01767276307482424855):0.00417732327064043903,nelsTAM01:0.01062151212275416930):0.00000100000050002909):0.00147639807709820268):0.00735816475855868499):0.01114808643085853958):0.00000100000050002909):0.00620498779261462186,discARI01:0.01260913775048936106):0.0;
Tree 2  = (((cemdSLP01:0.00000100000050002909,(laguBCS01:0.00000100000050002909,(((johaZAC01:0.00349510123643237197,((gera01S1:0.00000100000050002909,bung03s3A:0.00222943862049567983):0.00437115924055698612,(((lamb1195:0.00439963837678867056,krem03N12:0.00217213209428664686):0.00219303789955822837,(nelsTAM01:0.01097590378474356219,(maxtZAC01:0.00217737559363568884,((rzedMICH01:0.00000100000050002909,(caliCAL05:0.00000100000050002909,monoCAL01:0.00000100000050002909):0.00000100000050002909):0.00000100000050002909,(quadBC01:0.00217737493369005641,pincCOA01:0.00217463733471511380):0.00000100000050002909):0.00000100000050002909):0.00217737123055436813):0.00000100000050002909):0.00000100000050002909,(aris05S2:0.00000100000050002909,longUTAH01:0.00000100000050002909):0.00000100000050002909):0.00000100000050002909):0.00656735404027880207):0.00000100000050002909,fallUTAH01:0.00217610934426283511):0.00000100000050002909,orizPUE01:0.00217610929871295614):0.00000100000050002909):0.00000100000050002909):0.00000100000050002909,remoCOA01:0.00000100000050002909):0.00000100000050002909,(edulUTAH02:0.00000100000050002909,culmNL02:0.00000100000050002909):0.00000100000050002909,discARI01:0.00000100000050002909):0.0;
Tree 3  = ((edulUTAH02:0.00373547859976248618,(((aris05S2:0.00372719089007766046,longUTAH01:0.01780406315692957542):0.00121371584549834145,((nelsTAM01:0.00503075284241410060,(pincCOA01:0.00275943401936152351,(rzedMICH01:0.00583573234024142070,(maxtZAC01:0.00963219201954250946,fallUTAH01:0.02515022385583505493):0.00641735476350471790):0.00186739309652609003):0.00605414103918421390):0.00117258921866552441,(gera01S1:0.07400863361814664920,(lamb1195:0.09883097175980423699,(bung03s3A:0.04431943918493055912,krem03N12:0.02590407424283901194):0.00611904979697995913):0.01866722256868878077):0.00638409365049481814):0.00000100000050002909):0.00122977843245840671,((remoCOA01:0.00247984741365460436,cemdSLP01:0.00122555925547320290):0.00247964887280891291,(quadBC01:0.00123545356323630749,(orizPUE01:0.00000100000050002909,(((caliCAL05:0.00000100000050002909,johaZAC01:0.00000100000050002909):0.00000100000050002909,culmNL02:0.00000100000050002909):0.00000100000050002909,laguBCS01:0.00000100000050002909):0.00000100000050002909):0.00000100000050002909):0.00000100000050002909):0.00122943425614567342):0.00122942730582316817):0.00372275534452491327,monoCAL01:0.00000100000050002909,discARI01:0.00122982930547526573):0.0;
Tree 4  = (monoCAL01:0.01085025795213979093,((culmNL02:0.00166205795509647000,((maxtZAC01:0.00000100000050002909,pincCOA01:0.00166261489776196999):0.00166602753191035847,johaZAC01:0.00166600730707418959):0.00000100000050002909):0.01566174733325890328,((((((krem03N12:0.00785003418348303658,(lamb1195:0.00255812165124841241,(gera01S1:0.00000100000050002909,bung03s3A:0.00000100000050002909):0.00521144689415000643):0.00000100000050002909):0.00863828854814986669,(longUTAH01:0.00738576847970402392,(remoCOA01:0.03372485633596961768,nelsTAM01:0.02539553829021824055):0.00446839329080958841):0.00330254853946905947):0.00297810090205844228,((rzedMICH01:0.01958236678042093309,orizPUE01:0.00000100000050002909):0.00167938745685983866,laguBCS01:0.00513827474919368362):0.00340736454263290212):0.00000100000050002909,aris05S2:0.02495107149074670197):0.00338526389691240406,((quadBC01:0.00167213488975546378,fallUTAH01:0.00692332831275972987):0.00347973971577643110,(edulUTAH02:0.00869410837541570794,cemdSLP01:0.01958780876130842424):0.00000100000050002909):0.00342076957330453551):0.00000100000050002909,caliCAL05:0.00169256329132298679):0.00000100000050002909):0.00135484300620962797,discARI01:0.01448360831968148986):0.0;
Tree 5  = ((johaZAC01:0.00159328948321602547,((cemdSLP01:0.00159491291562049629,(culmNL02:0.00000100000050002909,edulUTAH02:0.00322793985270903878):0.00159835827396150759):0.00000100000050002909,(orizPUE01:0.00161191122867656135,laguBCS01:0.00485470113786591346):0.00159319942975560697):0.00319850447378525931):0.00000100000050002909,((((monoCAL01:0.00320051319278895395,fallUTAH01:0.00159747272778109880):0.00000100000050002909,(caliCAL05:0.00160137812552813919,quadBC01:0.00490071358250156967):0.00322081231397193697):0.00676863618959586393,(krem03N12:0.01299638524684694832,((lamb1195:0.01934706160176637157,(bung03s3A:0.01613992986154224110,gera01S1:0.01145506772996153153):0.00645086750585494983):0.00913025977649845923,((nelsTAM01:0.02176000711823935715,(remoCOA01:0.01004096071612971090,pincCOA01:0.00974365115690536618):0.02133492546406371565):0.00098336644034333672,(aris05S2:0.01290513819708043707,longUTAH01:0.00849819019049174139):0.00259891298291629056):0.00836202661411353937):0.03829978449664584589):0.01369132787432689700):0.00297470182893406218,(maxtZAC01:0.00000100000050002909,rzedMICH01:0.00158980048673195372):0.00000100000050002909):0.00159100957749826514,discARI01:0.00159405707431452661):0.0;
Tree 6  = ((johaZAC01:0.00000100000050002909,remoCOA01:0.00122955078874525492):0.00122878264818018800,(((edulUTAH02:0.00000100000050002909,(cemdSLP01:0.00000100000050002909,culmNL02:0.00000100000050002909):0.00000100000050002909):0.00000100000050002909,(((aris05S2:0.00000100000050002909,longUTAH01:0.00000100000050002909):0.00123004103735866138,(nelsTAM01:0.01146156362805143998,(lamb1195:0.01823508785227104592,((bung03s3A:0.00519422310849879110,gera01S1:0.00124863131247238634):0.00529855266653354081,krem03N12:0.00810325385119263844):0.00882682554031597941):0.00421070575727059814):0.00000100000050002909):0.00246313121949157717,(((monoCAL01:0.00000100000050002909,fallUTAH01:0.00122930184624523700):0.00122930095403326559,(quadBC01:0.00000100000050002909,caliCAL05:0.00000100000050002909):0.00000100000050002909):0.00246614083696940559,(laguBCS01:0.00000100000050002909,((pincCOA01:0.00123627112483384546,maxtZAC01:0.00123222939020597587):0.00123018874862002980,rzedMICH01:0.00246517972748487493):0.00123578009892516810):0.00000100000050002909):0.00122979254221406071):0.00000100000050002909):0.00000100000050002909,orizPUE01:0.00123122350059368135):0.00000100000050002909,discARI01:0.00246619198497854443):0.0;
Tree 7  = (((laguBCS01:0.00122390797802705647,orizPUE01:0.00494968178235456746):0.00000100000050002909,(((quadBC01:0.00122556279425338433,culmNL02:0.00370133827728106853):0.00000100000050002909,((caliCAL05:0.00122891419042204185,(monoCAL01:0.00000100000050002909,(maxtZAC01:0.00123213670361442713,(rzedMICH01:0.00000100000050002909,pincCOA01:0.00000100000050002909):0.00000100000050002909):0.00122892993198116360):0.00245914893046126704):0.00000100000050002909,(((fallUTAH01:0.00122790106481836204,((lamb1195:0.01032188896818238104,((bung03s3A:0.00147253442796729155,gera01S1:0.00921630647103153372):0.00418899379770148409,krem03N12:0.01259900746982780574):0.00318324776886082586):0.00611645009484210189,nelsTAM01:0.01591251498697717967):0.01873238714556929238):0.00000100000050002909,(cemdSLP01:0.00000100000050002909,edulUTAH02:0.00000100000050002909):0.00000100000050002909):0.00122885394393269071,(aris05S2:0.00755393352037064987,longUTAH01:0.00628562714382871306):0.00244526967267731871):0.00000100000050002909):0.00000100000050002909):0.00122876180100769342,remoCOA01:0.00245953297941278520):0.00000100000050002909):0.00000100000050002909,johaZAC01:0.00122406708607194288,discARI01:0.00122529560396293668):0.0;
Tree 8  = (cemdSLP01:0.00354028741401164835,(((((((edulUTAH02:0.00176466571748241322,caliCAL05:0.00534049984617196959):0.00000100000050002909,((rzedMICH01:0.00354809470093655436,nelsTAM01:0.00355928148552777648):0.00176580570859036592,((bung03s3A:0.00535473058082776374,(lamb1195:0.00177418411280343830,(krem03N12:0.01819678575082835439,gera01S1:0.00177439954904474529):0.00000100000050002909):0.00000100000050002909):0.00359760444660720989,(aris05S2:0.00177928163938970694,longUTAH01:0.00177566776780412484):0.00543307021286527046):0.00352239413724075379):0.00000100000050002909):0.00000100000050002909,(quadBC01:0.00000100000050002909,(remoCOA01:0.00000100000050002909,johaZAC01:0.00000100000050002909):0.00000100000050002909):0.00000100000050002909):0.00000100000050002909,fallUTAH01:0.00000100000050002909):0.00000100000050002909,(orizPUE01:0.00176672873946931105,maxtZAC01:0.00177019467274414587):0.00000100000050002909):0.00000100000050002909,monoCAL01:0.00000100000050002909):0.00000100000050002909,(pincCOA01:0.00532196265657295092,(laguBCS01:0.00176413708364523661,culmNL02:0.00354157499239014231):0.00000100000050002909):0.00000100000050002909):0.00000100000050002909,discARI01:0.00176672276888311264):0.0;
Tree 9  = ((((((((longUTAH01:0.00451794327487955311,aris05S2:0.00132355532111810207):0.00636566749210897183,(nelsTAM01:0.01814684831902978537,((gera01S1:0.00409123357293404450,(bung03s3A:0.00820740983532619421,krem03N12:0.00613550690656874693):0.00000100000050002909):0.00000100000050002909,lamb1195:0.00822423379748810426):0.02376717029067828071):0.00092359225032918933):0.03238645336233956368,rzedMICH01:0.00147073998550348523):0.00147519316267821668,(pincCOA01:0.00294058526738313376,maxtZAC01:0.00295066167239826276):0.00147888221670039758):0.00146365150769214121,caliCAL05:0.00146474560021246343):0.00000100000050002909,quadBC01:0.00146474092522127976):0.00442876680943619493,((edulUTAH02:0.00148151326929126621,((culmNL02:0.00147225366102844354,remoCOA01:0.00147071294372749730):0.00000100000050002909,(johaZAC01:0.00000100000050002909,((cemdSLP01:0.00000100000050002909,fallUTAH01:0.00000100000050002909):0.00000100000050002909,orizPUE01:0.00000100000050002909):0.00000100000050002909):0.00000100000050002909):0.00000100000050002909):0.00000100000050002909,monoCAL01:0.00294911991789714376):0.00147055547813885134):0.00000100000050002909,laguBCS01:0.00000100000050002909,discARI01:0.00000100000050002909):0.0;
Tree 10  = (((((nelsTAM01:0.00310018094109838988,(longUTAH01:0.00000100000050002909,aris05S2:0.00553328428604676122):0.00000100000050002909):0.00154806505751222193,(rzedMICH01:0.00159632395173005454,(remoCOA01:0.00000100000050002909,johaZAC01:0.00000100000050002909):0.00221838464373087275):0.00000100000050002909):0.00222186787777684100,fallUTAH01:0.00000100000050002909):0.00000100000050002909,(krem03N12:0.00589147104780762820,(lamb1195:0.02967404302864935089,(gera01S1:0.00158897912703387313,bung03s3A:0.00293688871839993017):0.00692144911106985436):0.05253591395967466271):0.00608022498285830382):0.00147526410130493471,((maxtZAC01:0.05201082293789145716,(edulUTAH02:0.00000100000050002909,((culmNL02:0.00000100000050002909,(quadBC01:0.00000100000050002909,(caliCAL05:0.00172781189436571115,(laguBCS01:0.00334931391159746334,cemdSLP01:0.00295649230540985389):0.00000100000050002909):0.00000100000050002909):0.00000100000050002909):0.00147870014247237277,(orizPUE01:0.00000100000050002909,pincCOA01:0.00164375743006789626):0.00000100000050002909):0.00147613185256608489):0.00000100000050002909):0.00000100000050002909,monoCAL01:0.00000100000050002909):0.00000100000050002909,discARI01:0.00000100000050002909):0.0;
Tree 11  = (((((laguBCS01:0.00233123853268123529,(((((nelsTAM01:0.00469902266682659022,longUTAH01:0.00235141325362246863):0.00000100000050002909,aris05S2:0.00000100000050002909):0.00000100000050002909,((krem03N12:0.00238090355839174362,lamb1195:0.00951328251185817701):0.00229163924861301455,(bung03s3A:0.00233599400179252412,gera01S1:0.00232822272099032475):0.00000100000050002909):0.00952636677791759284):0.00708691043052337225,((maxtZAC01:0.00233434635503051513,(pincCOA01:0.00000100000050002909,rzedMICH01:0.00234478865016037171):0.00000100000050002909):0.00235288291207344123,(monoCAL01:0.00000100000050002909,fallUTAH01:0.00000100000050002909):0.00000100000050002909):0.00000100000050002909):0.00235288174720836704,culmNL02:0.00234016832534242932):0.00000100000050002909):0.00000100000050002909,johaZAC01:0.00000100000050002909):0.00000100000050002909,edulUTAH02:0.00000100000050002909):0.00000100000050002909,(orizPUE01:0.00000100000050002909,cemdSLP01:0.00000100000050002909):0.00000100000050002909):0.00000100000050002909,((caliCAL05:0.00000100000050002909,remoCOA01:0.00000100000050002909):0.00000100000050002909,quadBC01:0.00000100000050002909):0.00000100000050002909,discARI01:0.00000100000050002909):0.0;
Tree 12  = ((rzedMICH01:0.00000100000050002909,(orizPUE01:0.00877986599367340526,((((remoCOA01:0.01276884945777609186,laguBCS01:0.00469624927254099454):0.00000100000050002909,fallUTAH01:0.00470503295420355433):0.00155853645201331167,((johaZAC01:0.01278554130918259889,(nelsTAM01:0.01174539859938891415,(pincCOA01:0.02047633785274694668,((maxtZAC01:0.02595364003308543721,(caliCAL05:0.02944368699457560259,(bung03s3A:0.02284838833838240615,(lamb1195:0.06422831903476981796,(krem03N12:0.01028420488936216889,gera01S1:0.03906402801383247053):0.00606774982029060269):0.00299673063256184445):0.00169914773623483788):0.00366998153245243078):0.00936817204104324446,aris05S2:0.01463883032840458849):0.00350539517532131271):0.00143662767828226998):0.00421885346421447746):0.00149702636187547386,monoCAL01:0.01767506630742322546):0.00000100000050002909):0.00000100000050002909,(cemdSLP01:0.00157863937182492562,((culmNL02:0.02653189419946880290,longUTAH01:0.03090886208847499692):0.02353953344005296072,quadBC01:0.01249969567870051583):0.01616030562054809536):0.00953241769753684041):0.00633213463017458754):0.00149466627923479497):0.00677366485118540557,edulUTAH02:0.02084490507959482070,discARI01:0.00337638848592786188):0.0;
Tree 13  = (((((remoCOA01:0.00000100000050002909,(orizPUE01:0.00000100000050002909,johaZAC01:0.00000100000050002909):0.00153915703641541320):0.00154206484051405343,((((((((fallUTAH01:0.00000100000050002909,laguBCS01:0.00000100000050002909):0.00000100000050002909,caliCAL05:0.00000100000050002909):0.00000100000050002909,cemdSLP01:0.00000100000050002909):0.00000100000050002909,culmNL02:0.00310788153798130474):0.00154734877424486119,(quadBC01:0.00000100000050002909,edulUTAH02:0.00154662770006899438):0.00000100000050002909):0.00315576381609025940,(aris05S2:0.00000100000050002909,longUTAH01:0.00000100000050002909):0.00629090230112423158):0.00150686245035741833,(krem03N12:0.01335106542006131609,(lamb1195:0.00280842572023034132,(bung03s3A:0.00139899888124363496,gera01S1:0.00140267992437584431):0.00000100000050002909):0.00419009647258042697):0.00707000836094011723):0.00000100000050002909,monoCAL01:0.00000100000050002909):0.00000100000050002909):0.00000100000050002909,nelsTAM01:0.00631599230849379852):0.00169728968639624913,rzedMICH01:0.00310042397224765797):0.00000100000050002909,(pincCOA01:0.00284106972451831415,maxtZAC01:0.00428644324535612260):0.00000100000050002909,discARI01:0.00310041802449566089):0.0;
Tree 14  = ((((monoCAL01:0.00000100000050002909,johaZAC01:0.00000100000050002909):0.00000100000050002909,caliCAL05:0.00000100000050002909):0.00000100000050002909,((cemdSLP01:0.00140692300559770137,culmNL02:0.00000100000050002909):0.00140128128187028719,(((((orizPUE01:0.00137544016432503548,remoCOA01:0.00275333517861555072):0.00139059735574300443,laguBCS01:0.00420179873826653175):0.00137948463753049416,((rzedMICH01:0.00138581264303058054,(longUTAH01:0.00392741724079421779,((lamb1195:0.00259444655865308802,((gera01S1:0.00000100000050002909,bung03s3A:0.00388159848765256979):0.00259204699182734397,krem03N12:0.00667854553965795388):0.00000100000050002909):0.01008771433632450754,(nelsTAM01:0.01021041108649529093,aris05S2:0.00699949143406136502):0.00123207301157132396):0.00315274896171754320):0.00111392219368541649):0.00000100000050002909,(pincCOA01:0.00000100000050002909,maxtZAC01:0.00416270977878670408):0.00140307565765651772):0.00000100000050002909):0.00231860304280527693,fallUTAH01:0.00388077747373074839):0.00221809388547549152,edulUTAH02:0.00139391118521773423):0.00000100000050002909):0.00000100000050002909):0.00000100000050002909,quadBC01:0.00000100000050002909,discARI01:0.00000100000050002909):0.0;
Tree 15  = ((((aris05S2:0.01320975426919473138,((nelsTAM01:0.01024025443175876314,(lamb1195:0.01481457340610610289,((bung03s3A:0.00340119499244438163,gera01S1:0.00691349077176561105):0.00507566632424353084,longUTAH01:0.00709651497266250951):0.04790137054229393065):0.00000100000050002909):0.00290670792620150754,krem03N12:0.02435598961535419271):0.00000100000050002909):0.00282120179547466852,((rzedMICH01:0.00142903229453673615,(maxtZAC01:0.00000100000050002909,pincCOA01:0.00000100000050002909):0.00140114081961747474):0.01040160487004891665,(fallUTAH01:0.00819150057732223602,(monoCAL01:0.00629551905050659572,quadBC01:0.00548009807766638556):0.00544690611063343346):0.00354884615838011071):0.00138246995744196197):0.00142121739651640197,laguBCS01:0.00138881677585639841):0.00140885433793278133,(((cemdSLP01:0.00140612110799951924,johaZAC01:0.00425198797542691680):0.00000100000050002909,orizPUE01:0.00000100000050002909):0.00000100000050002909,(remoCOA01:0.00000100000050002909,((caliCAL05:0.01026400716879240747,edulUTAH02:0.00000100000050002909):0.00143004801045787627,culmNL02:0.00142543817408530326):0.00142271649807424079):0.00425319650601518103):0.00140792792767480417,discARI01:0.00140343197670899224):0.0;
Tree 16  = ((cemdSLP01:0.00150104966666544004,((((monoCAL01:0.00000100000050002909,caliCAL05:0.01217020127080442604):0.01519427890735339758,edulUTAH02:0.00000100000050002909):0.00150012000169469665,(((culmNL02:0.00000100000050002909,(quadBC01:0.00000100000050002909,johaZAC01:0.00000100000050002909):0.00000100000050002909):0.00000100000050002909,((fallUTAH01:0.00149822645275782848,((nelsTAM01:0.01806292385166524336,((gera01S1:0.14831278620879681518,bung03s3A:0.00421286245938705742):0.00621039517648546650,(lamb1195:0.03770277602172024400,krem03N12:0.01675674058907318867):0.00312306427036105651):0.00150275088050141913):0.00150040765021731406,(longUTAH01:0.00000100000050002909,aris05S2:0.00000100000050002909):0.00301344575922313620):0.00150247878749296625):0.00000100000050002909,(rzedMICH01:0.00300622386556651357,remoCOA01:0.00149837275444109639):0.00000100000050002909):0.00000100000050002909):0.00000100000050002909,(maxtZAC01:0.00000100000050002909,pincCOA01:0.00000100000050002909):0.00000100000050002909):0.00000100000050002909):0.00149953312532082939,laguBCS01:0.00149954957552112965):0.00000100000050002909):0.00000100000050002909,orizPUE01:0.00149937105948953786,discARI01:0.00150026134788787098):0.0;
Tree 17  = (quadBC01:0.00000100000050002909,(((((rzedMICH01:0.00159704186838188051,(orizPUE01:0.00150264512940845329,maxtZAC01:0.00147857104304013279):0.00021002559689413446):0.00000100000050002909,(culmNL02:0.00159818401538376967,((((aris05S2:0.00000100000050002909,longUTAH01:0.00320640117702771302):0.00429363443163239839,((bung03s3A:0.00159963213663235596,(lamb1195:0.00965979753636969467,gera01S1:0.00233749203428234133):0.00100370923892100904):0.00161586291306078781,krem03N12:0.00484631331838092545):0.00215550314740442376):0.13345055826113830233,nelsTAM01:0.00249810045649091761):0.00397886901525919094,(monoCAL01:0.00320596832514754996,caliCAL05:0.00000100000050002909):0.00159350419548509093):0.00000100000050002909):0.00000100000050002909):0.00000100000050002909,(((pincCOA01:0.00000100000050002909,remoCOA01:0.00000100000050002909):0.00000100000050002909,edulUTAH02:0.00000100000050002909):0.00000100000050002909,(fallUTAH01:0.00000100000050002909,laguBCS01:0.00000100000050002909):0.00000100000050002909):0.00000100000050002909):0.00000100000050002909,johaZAC01:0.00000100000050002909):0.00000100000050002909,cemdSLP01:0.00000100000050002909):0.00000100000050002909,discARI01:0.00000100000050002909):0.0;
Tree 18  = (johaZAC01:0.00000100000050002909,(((laguBCS01:0.00286851726617342109,monoCAL01:0.00143143357265590920):0.00000100000050002909,(((quadBC01:0.00000100000050002909,((cemdSLP01:0.00000100000050002909,orizPUE01:0.00000100000050002909):0.00000100000050002909,caliCAL05:0.00000100000050002909):0.00000100000050002909):0.00000100000050002909,edulUTAH02:0.00000100000050002909):0.00000100000050002909,(culmNL02:0.00143628284278833444,((((lamb1195:0.01334345679259882692,(krem03N12:0.00882444911809161792,bung03s3A:0.02129418470942314248):0.00000100000050002909):0.00398386330781908254,(gera01S1:0.02161480876554189995,((longUTAH01:0.00283610096793128529,aris05S2:0.00000100000050002909):0.00391492456597961926,nelsTAM01:0.00504893042289503591):0.01358368242773993866):0.01879300174203434384):0.00474142387769594959,((rzedMICH01:0.00143758531446501513,pincCOA01:0.00000100000050002909):0.00000100000050002909,maxtZAC01:0.00431958327436093685):0.00289185423407966333):0.00436494521023143411,fallUTAH01:0.00143132408181992723):0.00000100000050002909):0.00000100000050002909):0.00000100000050002909):0.00000100000050002909,remoCOA01:0.00143167065572288778):0.00143143291739213194,discARI01:0.00287744442415338152):0.0;
Tree 19  = (((((((aris05S2:0.00361677434923380389,longUTAH01:0.00119632672608653047):0.00000100000050002909,nelsTAM01:0.00240129473120629733):0.00119640549202963513,(krem03N12:0.00522976444191382544,(lamb1195:0.00483037139220662912,(bung03s3A:0.00243782182287818720,gera01S1:0.00118467917277596466):0.00364268325855913924):0.00000100000050002909):0.00120488205176996440):0.00000100000050002909,((((orizPUE01:0.00118725667182262100,cemdSLP01:0.00121315712488654650):0.00362541640409431683,pincCOA01:0.00240481090030115856):0.00000100000050002909,edulUTAH02:0.00000100000050002909):0.00000100000050002909,(rzedMICH01:0.00240921381383104542,maxtZAC01:0.00118723123674904720):0.00121338020299023444):0.00119501687420561125):0.00240775553689637298,quadBC01:0.00120833098715960653):0.00119592506375677940,(((caliCAL05:0.00119409820164301868,fallUTAH01:0.00120225789712451962):0.00000100000050002909,culmNL02:0.00000100000050002909):0.00000100000050002909,(johaZAC01:0.00119220696722163017,(remoCOA01:0.00118867009394240416,monoCAL01:0.00000100000050002909):0.00119221871583841273):0.00245568103235825445):0.00120337839381569767):0.00120171554757165762,laguBCS01:0.00119617139683759251,discARI01:0.00000100000050002909):0.0;
Tree 20  = (((rzedMICH01:0.00000100000050002909,(((laguBCS01:0.00000100000050002909,orizPUE01:0.00000100000050002909):0.00000100000050002909,(edulUTAH02:0.00000100000050002909,((remoCOA01:0.00327391701547175918,maxtZAC01:0.00491454873245106977):0.00000100000050002909,((((lamb1195:0.00328909609378753116,(pincCOA01:0.01327892251796371562,(gera01S1:0.00495887153480049740,bung03s3A:0.00495715371961307199):0.00494356817901409670):0.00000100000050002909):0.00000100000050002909,krem03N12:0.00497563728785143083):0.01672672266466892696,(longUTAH01:0.00328023009361017026,(nelsTAM01:0.00824825270532599658,aris05S2:0.00327434073914698162):0.00164232674223041509):0.00163358489870046105):0.00163782402203907452,culmNL02:0.00328443690494143771):0.00000100000050002909):0.00000100000050002909):0.00000100000050002909):0.00000100000050002909,quadBC01:0.00000100000050002909):0.00000100000050002909):0.00000100000050002909,(cemdSLP01:0.00327329452357253206,(monoCAL01:0.00000100000050002909,(johaZAC01:0.00000100000050002909,fallUTAH01:0.00000100000050002909):0.00000100000050002909):0.00163542463336650693):0.00000100000050002909):0.00000100000050002909,caliCAL05:0.00163572834248821002,discARI01:0.00163572836503438697):0.0;


end;
begin phylonet;
Infer_ST_MDC (1-20) -a <quadrifolia:quadBC01;fallax:fallUTAH01;monophylla:monoCAL01;californiarum:caliCAL05;nelsonii:nelsTAM01;maximartinezii:maxtZAC01;pinceana:pincCOA01;rzedowskii:rzedMICH01;johannis:johaZAC01;cembroides:cemdSLP01;lagunae:laguBCS01;orizabensis:orizPUE01;remota:remoCOA01;edulis:edulUTAH02;culminicola:culmNL02;discolor:discARI01;gerardiana:gera01S1;bungeana:bung03s3A;krempfii:krem03N12;aristata:aris05S2;longaeva:longUTAH01;lambertiana:lamb1195;
[InferNetwork_ML (1-20) 2 -di -pl 4 -x 20 -a <quadrifolia:quadBC01;fallax:fallUTAH01;monophylla:monoCAL01;californiarum:caliCAL05;nelsonii:nelsTAM01;maximartinezii:maxtZAC01;pinceana:pincCOA01;rzedowskii:rzedMICH01;johannis:johaZAC01;cembroides:cemdSLP01;lagunae:laguBCS01;orizabensis:orizPUE01;remota:remoCOA01;edulis:edulUTAH02;culminicola:culmNL02;discolor:discARI01;gerardiana:gera01S1;bungeana:bung03s3A;krempfii:krem03N12;aristata:aris05S2;longaeva:longUTAH01;lambertiana:lamb1195;]
[InferNetwork_ML (1-20) 1 -di -pl 4 -x 20 -h {remo} -a <quadrifolia:quadBC01;fallax:fallUTAH01;monophylla:monoCAL01;californiarum:caliCAL05;nelsonii:nelsTAM01;maximartinezii:maxtZAC01;pinceana:pincCOA01;rzedowskii:rzedMICH01;johannis:johaZAC01;cembroides:cemdSLP01;lagunae:laguBCS01;orizabensis:orizPUE01;remota:remoCOA01;edulis:edulUTAH02;culminicola:culmNL02;discolor:discARI01;gerardiana:gera01S1;bungeana:bung03s3A;krempfii:krem03N12;aristata:aris05S2;longaeva:longUTAH01;lambertiana:lamb1195;
[CalGTProb net (1-20) -a <quadrifolia:quadBC01;fallax:fallUTAH01;monophylla:monoCAL01;californiarum:caliCAL05;nelsonii:nelsTAM01;maximartinezii:maxtZAC01;pinceana:pincCOA01;rzedowskii:rzedMICH01;johannis:johaZAC01;cembroides:cemdSLP01;lagunae:laguBCS01;orizabensis:orizPUE01;remota:remoCOA01;edulis:edulUTAH02;culminicola:culmNL02;discolor:discARI01;gerardiana:gera01S1;bungeana:bung03s3A;krempfii:krem03N12;aristata:aris05S2;longaeva:longUTAH01;lambertiana:lamb1195;]

end;


```

**NOTA**. Si desea reducir el número de terminales te recomiendo leer el tutorial de [Beforephylo](https://github.com/JR-Montes/Tutorial-BeforePhylo/blob/master/Tutorial%20BeforePhylo.md) en este repositorio. 


**NOTA** Si deseas correr una tanda de alineamientos en RAxML te recomiendo leer el tutorial de [RAxML](https://github.com/JR-Montes/RAxML-on-Single-and-Multilocus/blob/master/RAxML_Multilocus.md) en este repositorio.


**En Phylonet**

Una vez que cuentas con el archivo NEXUS con todos lo árboles y las indicaciones al final del archivo, lo siguiente es correr la hipótesis nula sin ningún evento de reticulación. El análisis utiliza Minimize Deep Coalescence (MDC):

`nohup java -jar /usr/local/bin/PhyloNet_3.6.1.jar alltrees3.tre >MDC.out1.txt &`

Para calcular la red con un evento reticulación, abre el archivo de árboles con `nano` y borra la linea `Infer_ST_MDC (1-20);` y remover los brackets `[ ]` de la línea que empieza con `InferNetwork_MP`. Ahora escribe la siguiente línea de comandos:


`nohup java -jar /usr/local/bin/PhyloNet_3.6.1.jar alltrees3.tre >ret1.out1.txt &`

Puede ser conveniente correr múltiples trabajos y comparar los resultados:

`nohup java -jar /usr/local/bin/PhyloNet_3.6.1.jar alltrees3.tre >ret1.out2.txt &`

**NOTA** Se recomiendo correr 10 réplicas de por cada evento de reticulación. 


**Cómo interpretar los resultados**

1. Abrir el archivo `MDC_out.txt` y copiar el árbol en formato NEWICK que viene al final del archivo y anotar el número de linajes. El número de linajes lo debes comparar con el número de linajes de las 10 réplicas del primer evento de reticulación. De esta manera podrás elegir la reticulación con el menor número de linajes.


```
Infer_ST_MDC (20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1)
(discARI01:0.0,((((edulUTAH02:0.0,fallUTAH01:0.0):278.0,(caliBC01:0.0,(monoUSA01:0.0,quadBC01:0.0):251.0):482.0):852.0,((johaZAC01:0.0,culmNL02:0.0):255.0,((rzedMICH01:0.0,(maxtZAC01:0.0,pincCOA01:0.0):207.0):266.0,((aris05S2:0.0,longUTAH01:0.0):114.0,(nelsTAM01:0.0,((bung03s3A:0.0,gera01S1:0.0):107.0,(lamb1195:0.0,krem03N12:0.0):184.0):92.0):302.0):210.0):546.0):1047.0):1588.0,((laguBCS01:0.0,orizPUE01:0.0):273.0,(cemdSLP01:0.0,remoCOA01:0.0):284.0):746.0):0.0):0.0;
 Total number of extra lineages:8084.0
 
```

2. Visualizar el árbol en Dendroscope


 ![Tree](https://github.com/JR-Montes/Tutorial-Phylonet/blob/master/Captura%20de%20pantalla%202020-03-17%20a%20la(s)%2021.25.29.png)


3. Abrir el archivo `ret1_out.txt` y copiar el árbol en formato NEWICK que viene al final del archivo y anotar el número de linajes. 

```
Inferred Network #1:
(((((johaZAC01,(quadBC01)#H1:1.0::0.35507246376811596),culmNL02),(((nelsTAM01,((bung03s3A,gera01S1),(krem03N12,lamb1195))),(longUTAH01,aris05S2)),((pincCOA01,maxtZAC01),rzedMICH01))),((((monoUSA01,#H1:::0.644927536231884),caliBC01),(edulUTAH02,fallUTAH01)),((remoCOA01,cemdSLP01),(laguBCS01,orizPUE01)))),discARI01);

Total number of extra lineages: 7743.0
Visualize in Dendroscope : (((((johaZAC01,(quadBC01)#H1),culmNL02),(((nelsTAM01,((bung03s3A,gera01S1),(krem03N12,lamb1195))),(longUTAH01,aris05S2)),((pincCOA01,maxtZAC01),rzedMICH01))),((((monoUSA01,#H1),caliBC01),(edulUTAH02,fallUTAH01)),((remoCOA01,cemdSLP01),(laguBCS01,orizPUE01)))),discARI01);
```

En el árbol en formato NEWICK que se encuentra justo después de la línea `Inferred Network #1:` vamos a encontrar dos valores en puntos decimales. En este caso son `0.3550724637...` y `0.64492753...` Esos valores indican el porcentaje de heredabilidad de los ejemplares parentales al individuo introgresado o hibridizado. 

![Reticulation](https://github.com/JR-Montes/Tutorial-Phylonet/blob/master/Captura%20de%20pantalla%202020-03-17%20a%20la(s)%2021.46.02.png)





Referencias

Maddison, W.P. 1997. Gene trees in species trees. Systematic Biology 46: 523–536.

Than, C., D. Ruths, and L. Nakhleh. 2008. PhyloNet: a software package for analyzing and reconstructing reticulate evolutionary relationships. BMC Bioinformatics 9: 322.

Than, C., and L. Nakhleh. 2009. Species tree inference by minimizing deep coalescences. PLoS Computational Biology 5: e1000501.


